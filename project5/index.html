<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<style>
  body {
    padding: 100px;
    width: 1000px;
    margin: auto;
    text-align: left;
    font-weight: 300;
    font-family: 'Open Sans', sans-serif;
    color: #121212;
  }
  h1, h2, h3, h4 {
    font-family: 'Source Sans Pro', sans-serif;
  }
</style>
<title>CS 184/284A Rasterizer</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link href="https://fonts.googleapis.com/css?family=Open+Sans|Source+Sans+Pro" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>


<body>

<h1>
<!-- <a href="https://cal-cs184-student.github.io/hw-webpages-sp24-calvintvu/hw1/index.html">https://cal-cs184-student.github.io/hw-webpages-sp24-calvintvu/hw1/index.html</a>   -->
</h1>

<h1 align="middle">CS 180: Computer Vision & Computational Photography, Fall 2024</h1>
<h1 align="middle">Project 5: Diffusion Models</h1>
<h2 align="middle">Calvin Vu</h2>

<div align="middle">
    <table style="width=100%">
      <tr>
        <td>
          <img src="output/Generation-with-Diffusion-Models.png" align="middle" width="1000px"/>
        </td>
    </table>
  </div>

<div>

<h2 align="middle">Overview</h2>
<p>In this assignment, we will explore diffusion models, implement diffusion sampling loops, and use them for other tasks such as inpainting and 
    creating optical illusions. We will also train our own diffusion model on the MNIST dataset.
</p>

<h1 align="middle">Part A: The Power of Diffusion Models!</h1>

<h2 align="middle">Part A - Section 0: Setup</h2>

<p>First, we need to install our dependencies, load the models, seed our work, and test the model with the provided sampling loops. We are using seed 180.
</p>


<div align="middle">
  <table style="width=100%">
    <tr>
      <td>
        <img src="output/20inf.png" align="left" width="600px"/>
        <figcaption align="middle">3 Prompts - 20 Inference Steps</figcaption>
      </td>
    </tr>
    <br><br>
  </table>
</div>
<div align="middle">
    <table style="width=100%">
        <tr>
            <td>
                <img src="output/40inf.png" align="middle" width="600px"/>
                <figcaption align="middle">3 Prompts - 40 Inference Steps</figcaption>
              </td>
        </tr>
      <br><br>
    </table>
  </div>



<h2 align="middle">Part A - Section 1: Sampling Loops</h2>

<p>
    Starting with a clean image, <b>x<sub>0</sub></b>, we can iteratively add noise to an image, obtaining progressively more and more noisy versions of the 
    image, <b>x<sub>t</sub></b>, until we're left with basically pure noise at timestep <b>t = T</b>. When <b>t = 0</b>, we have a clean image, and for 
    larger <b>t</b> more noise is in the image. A diffusion model tries to reverse this process by denoising the image. By giving a diffusion model a 
    noisy <b>x<sub>t</sub></b> and the timestep <b>t</b>, the model predicts the noise in the image. With the predicted noise, we can either
    completely remove the noise from the image, to obtain an estimate of <b>x<sub>0</sub></b>, or we can remove just a portion of the noise, 
    obtaining an estimate of <b>x<sub>t-1</sub></b>, with slightly less noise. To generate images from the diffusion model (sampling), we 
    start with pure noise at timestep <b>T</b> sampled from a gaussian distribution, which we denote <b>x<sub>T</sub></b>. We can then predict and 
    remove part of the noise, giving us <b>x<sub>T-1</sub></b>. Repeating this process until we arrive at <b>x<sub>0</sub></b> gives us a clean image.
</p>
<p>
    For stage 1, we will use a test image, but resize it down to a 64x64 image and convert it to a (1, 3, 64, 64) tensor.
</p>
<div align="middle">
    <table style="width=100%">
        <tr>
            <td>
                <img src="output/test_image.png" align="middle" width="100px"/>
                <figcaption align="middle">Test Image</figcaption>
              </td>
        </tr>
      <br><br>
    </table>
  </div>

<h3 align="middle">Part A - Section 1.1:  Implementing the Forward Process</h3>
<p>
    The forward process can be defined by this equation:
    \[
    x_t = \sqrt{\bar{\alpha}}x_0 + \sqrt{1 - \bar{\alpha_t}}\epsilon \enspace where \enspace \epsilon \sim  N(0,1)
    \]

    That is, given a clean image <b>x<sub>0</sub></b>, we get a noisy image <b>x<sub>t</sub></b> at timestep <b>t</b> by sampling from a Gaussian 
    with mean $$\sqrt{\bar{\alpha}}x_0$$ and variance $$ (1 - \bar\alpha_t). $$ Note that the forward process is not just adding noise -- we also scale the image.
</p>

<h3 align="middle">Part A - Section 1.2:  Classical Denoising</h3>
<p>
    We will try to remove noise from the image, using Gaussian blur filtering, but this will be impossible for the most part.
</p>

  <h3 align="middle">Part A - Section 1.3:  Implementing One Step Denoising</h3>
<p>
    Instead of blurring, we'll use a pretrained diffusion model to denoise. The actual denoiser can be found at stage_1.unet. We can estimate this with
    \[
    image \enspace - \enspace \sqrt{1 - \bar{\alpha_t}} \enspace * \enspace (noise\:estimate) / \sqrt{\bar{\alpha_t}}
    \]
</p>
<div align="middle">
    <table style="width=100%">
      <tr>
        <td>
          <img src="output/1.1-1.3.png" align="left" width="300px"/>
          <figcaption align="middle"</figcaption>
        </td>
      </tr>
      <br><br>
    </table>
  </div>

  <h2 align="middle">Part A - Section 1.4: Implementing Iterative Denoising</h2>

  <p>
    We saw that the denoising UNet does a much better job of projecting the image onto the natural image manifold, but it does get worse as you add 
    more noise. This makes sense, as the problem is much harder with more noise! But diffusion models are designed to denoise iteratively. We can speed
    up this iterative process by skipping steps.
    To skip steps we can create a list of timesteps that we'll call <b>strided_timesteps</b>, which will be much shorter than the full list of 1000 
    timesteps. <b>strided_timesteps[0]</b> will correspond to the noisiest image (and thus the largest <b>t</b>) and <b>strided_timesteps[-1]</b> will correspond 
    to a clean image (and thus <b>t = 0</b>). One simple way of constructing this list is by introducing a regular stride step (e.g. stride of 30
     works well). On the ith denoising step we are at  <b>t =  strided_timesteps[i]</b>, and want to get to  <b>t' = strided_timesteps[i+1]</b> (from more noisy to less noisy). To actually do this, we have the following formula:

    \[
    x_{t'} = \frac{\sqrt{\bar\alpha_{t'}}\beta_t}{1 - \bar\alpha_t} x_0 +
        \frac{\sqrt{\alpha_t}(1 - \bar\alpha_{t'})}{1 - \bar\alpha_t} x_t +
        v_\sigma
    \]
    <li> <b>x<sub>t</sub></b> is your image at timestep <b>t</b> </li>
    <li> <b>x<sub>t'</sub></b> is your noisy image at timestep <b>t'</b> where <b>t' < t </b> (less noisy)</li>
    <li><math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
          <mrow data-mjx-texclass="ORD">
            <mover>
              <mi>&#x3B1;</mi>
              <mo stretchy="false">&#xAF;</mo>
            </mover>
          </mrow>
          <mi>t</mi>
        </msub>
      </math> is defined as alphas_cumprod</li>
    <li><math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
          <mi>&#x3B1;</mi>
          <mi>t</mi>
        </msub>
        <mo>=</mo>
        <mfrac>
          <msub>
            <mrow data-mjx-texclass="ORD">
              <mover>
                <mi>&#x3B1;</mi>
                <mo stretchy="false">&#xAF;</mo>
              </mover>
            </mrow>
            <mi>t</mi>
          </msub>
          <msub>
            <mrow data-mjx-texclass="ORD">
              <mover>
                <mi>&#x3B1;</mi>
                <mo stretchy="false">&#xAF;</mo>
              </mover>
            </mrow>
            <mrow data-mjx-texclass="ORD">
              <msup>
                <mi>t</mi>
                <mo data-mjx-alternate="1">&#x2032;</mo>
              </msup>
            </mrow>
          </msub>
        </mfrac>
      </math></li>
      <li>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <msub>
              <mi>&#x3B2;</mi>
              <mi>t</mi>
            </msub>
            <mo>=</mo>
            <mn>1</mn>
            <mo>&#x2212;</mo>
            <msub>
              <mi>&#x3B1;</mi>
              <mi>t</mi>
            </msub>
          </math>
      </li>
      <li> <b>x<sub>0</sub></b> is our current estimate of the clean image </li>
  </p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
          <img src="output/1.4.png" align="left" width="300px"/>
          <figcaption align="middle"</figcaption>
        </td>
      </tr>
      <br><br>
    </table>
  </div>

  <h2 align="middle">Part A - Section 1.5: Diffusion Model Sampling</h2>

  <p>
    We can use the <b>iterative_denoise</b> function is to generate images from scratch. We can do this by setting <b>i_start = 0</b> and passing in random noise. This effectively denoises pure noise.
  </p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
          <img src="output/1.5image0.png" align="middle" width="100px"/>
          <figcaption align="middle">Sample 1</figcaption>
        </td>
        <td>
            <img src="output/1.5image1.png" align="middle" width="100px"/>
            <figcaption align="middle">Sample 2</figcaption>
          </td>
          <td>
            <img src="output/1.5image2.png" align="middle" width="100px"/>
            <figcaption align="middle">Sample 3</figcaption>
          </td>
          <td>
            <img src="output/1.5image3.png" align="middle" width="100px"/>
            <figcaption align="middle">Sample 4</figcaption>
          </td>
          <td>
            <img src="output/1.5image4.png" align="middle" width="100px"/>
            <figcaption align="middle">Sample 5</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>

  <h2 align="middle">Part A - Section 1.6: Classifier Free Guidance</h2>

  <p>
    You may have noticed that some of the generated images in the prior section are not very good. We can improve the output with Classifer Free Guidance
    (CFG). We define a new noise estimate 
    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <mtable displaystyle="true">
          <mlabeledtr>
            <mtd id="mjx-eqn:A.4">
            </mtd>
            <mtd>
              <mi>&#x3F5;</mi>
              <mo>=</mo>
              <msub>
                <mi>&#x3F5;</mi>
                <mi>u</mi>
              </msub>
              <mo>+</mo>
              <mi>&#x3B3;</mi>
              <mo stretchy="false">(</mo>
              <msub>
                <mi>&#x3F5;</mi>
                <mi>c</mi>
              </msub>
              <mo>&#x2212;</mo>
              <msub>
                <mi>&#x3F5;</mi>
                <mi>u</mi>
              </msub>
              <mo stretchy="false">)</mo>
            </mtd>
          </mlabeledtr>
        </mtable>
      </math>
      where &gamma; controls the strength of CFG. Notice that for &gamma; = 0, we get an unconditional noise estimate, and for &gamma; = 1 we 
      get the conditional noise estimate. The magic happens when &gamma; > 1.
  </p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
          <img src="output/1.6image0.png" align="middle" width="100px"/>
          <figcaption align="middle">Sample 1</figcaption>
        </td>
        <td>
            <img src="output/1.6image1.png" align="middle" width="100px"/>
            <figcaption align="middle">Sample 2</figcaption>
          </td>
          <td>
            <img src="output/1.6image2.png" align="middle" width="100px"/>
            <figcaption align="middle">Sample 3</figcaption>
          </td>
          <td>
            <img src="output/1.6image3.png" align="middle" width="100px"/>
            <figcaption align="middle">Sample 4</figcaption>
          </td>
          <td>
            <img src="output/1.6image4.png" align="middle" width="100px"/>
            <figcaption align="middle">Sample 5</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>

  <h2 align="middle">Part A - Section 1.7: Image-to-image Translation</h2>
  <p>
    In Section 1.4, we take a real image, add noise to it, and then denoise. This effectively allows us to make edits to existing images. The 
    more noise we add, the larger the edit will be. This works because in order to denoise an image, the diffusion model must to some extent 
    "hallucinate" new things -- the model has to be "creative." Another way to think about it is that the denoising process "forces" a noisy image 
    back onto the manifold of natural images. Here, we're going to take the original test image, noise it a little, and force it back onto the image 
    manifold without any conditioning. Effectively, we're going to get an image that is similar to the test image (with a low-enough noise level).
  </p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/test_image.png" align="middle" width="100px"/>
            <figcaption align="middle">campanile</figcaption>
          </td>
        <td>
          <img src="output/1.7_testimage1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7_testimage3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7_testimage5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7_testimage7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7_testimage10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7_testimage20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/testimage1.jpg" align="middle" width="100px"/>
            <figcaption align="middle">car</figcaption>
          </td>
        <td>
          <img src="output/1.7_test1image1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7_test1image3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7_test1image5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7_test1image7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7_test1image10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7_test1image20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/testimage2.jpg" align="middle" width="100px"/>
            <figcaption align="middle">statue</figcaption>
          </td>
          <td>
        <td>
          <img src="output/1.7_test2image1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7_test2image3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7_test2image5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7_test2image7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7_test2image10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7_test2image20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>


  <h3 align="middle">Part A - Section 1.7.1: Editing Hand-Drawn and Web Images</h3>

  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/avocado.png" align="middle" width="100px"/>
            <figcaption align="middle">avocado</figcaption>
          </td>
          <td>
        <td>
          <img src="output/1.7.1_testimage1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7.1_testimage3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_testimage5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_testimage7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_testimage10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_testimage20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>

  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/drawing1.jpg" align="middle" width="100px"/>
            <figcaption align="middle">face</figcaption>
          </td>
          <td>
        <td>
          <img src="output/1.7.1_test1image1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7.1_test1image3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test1image5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test1image7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test1image10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test1image20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>

  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/drawing2.jpg" align="middle" width="100px"/>
            <figcaption align="middle">sword</figcaption>
          </td>
          <td>
        <td>
          <img src="output/1.7.1_test2image1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7.1_test2image3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test2image5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test2image7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test2image10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test2image20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>

  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/webimage.jpg" align="middle" width="100px"/>
            <figcaption align="middle">dog</figcaption>
          </td>
          <td>
        <td>
          <img src="output/1.7.1_test3image1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7.1_test3image3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test3image5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test3image7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test3image10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7.1_test3image20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>

  <h3 align="middle">Part A - Section 1.7.2: Inpainting</h3>
  <p>
    Given an image <b>x<sub>orig</sub></b>, and a binary mask <b>m</b>, we can create a new image that has the same content where <b>m</b> is 0, but new content wherever 
    <b>m</b> is 1. To do this, we can run the diffusion denoising loop. But at every step, after obtaining <b>x<sub>t</sub></b>, we "force" <b>x<sub>t</sub></b>to have the 
    same pixels as <b>x<sub>orig</sub></b> where <b>m</b> is 0:
    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <mtable displaystyle="true">
          <mlabeledtr>
            <mtd id="mjx-eqn:A.5">
            </mtd>
            <mtd>
              <msub>
                <mi>x</mi>
                <mi>t</mi>
              </msub>
              <mo stretchy="false">&#x2190;</mo>
              <mtext mathvariant="bold">m</mtext>
              <msub>
                <mi>x</mi>
                <mi>t</mi>
              </msub>
              <mo>+</mo>
              <mo stretchy="false">(</mo>
              <mn>1</mn>
              <mo>&#x2212;</mo>
              <mtext mathvariant="bold">m</mtext>
              <mo stretchy="false">)</mo>
              <mtext>forward</mtext>
              <mo stretchy="false">(</mo>
              <msub>
                <mi>x</mi>
                <mrow data-mjx-texclass="ORD">
                  <mi>o</mi>
                  <mi>r</mi>
                  <mi>i</mi>
                  <mi>g</mi>
                </mrow>
              </msub>
              <mo>,</mo>
              <mi>t</mi>
              <mo stretchy="false">)</mo>
            </mtd>
          </mlabeledtr>
        </mtable>
      </math>

  </p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/inpaint1.png" align="middle" width="100px"/>
            <figcaption align="middle">inpainted</figcaption>
          </td>
          <td>
        <td>
          <img src="output/inpaint1image.png" align="middle" width="100px"/>
          <figcaption align="middle">image</figcaption>
        </td>
        <td>
            <img src="output/inpaint1mask.png" align="middle" width="100px"/>
            <figcaption align="middle">mask</figcaption>
          </td>
          <td>
      </tr>
      <br><br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/inpaint2.png" align="middle" width="100px"/>
            <figcaption align="middle">inpainted</figcaption>
          </td>
          <td>
        <td>
          <img src="output/inpaint2image.png" align="middle" width="100px"/>
          <figcaption align="middle">image</figcaption>
        </td>
        <td>
            <img src="output/inpaint2mask.png" align="middle" width="100px"/>
            <figcaption align="middle">mask</figcaption>
          </td>
          <td>
      </tr>
      <br><br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/inpaint3.png" align="middle" width="100px"/>
            <figcaption align="middle">inpainted</figcaption>
          </td>
          <td>
        <td>
          <img src="output/inpaint3image.png" align="middle" width="100px"/>
          <figcaption align="middle">image</figcaption>
        </td>
        <td>
            <img src="output/inpaint3mask.png" align="middle" width="100px"/>
            <figcaption align="middle">mask</figcaption>
          </td>
          <td>
      </tr>
      <br><br>
    </table>
  </div>

  <h3 align="middle">Part A - Section 1.7.3: Text-Conditional Image-to-image Translation</h3>
  <p>
    We will do the same thing as Section 1.7, but guide the projection with a text prompt. We will use the prompt "a rocket ship".
  </p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/test_image.png" align="middle" width="100px"/>
            <figcaption align="middle">campanile</figcaption>
          </td>
        <td>
          <img src="output/1.7.3_testimage1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7.3_testimage3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_testimage5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_testimage7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_testimage10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_testimage20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>

  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/testimage1.jpg" align="middle" width="100px"/>
            <figcaption align="middle">car</figcaption>
          </td>
        <td>
          <img src="output/1.7.3_test1image1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7.3_test1image3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_test1image5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_test1image7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_test1image10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_test1image20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>

  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/testimage2.jpg" align="middle" width="100px"/>
            <figcaption align="middle">statue</figcaption>
          </td>
        <td>
          <img src="output/1.7.3_test2image1.png" align="middle" width="100px"/>
          <figcaption align="middle">i_start = 1</figcaption>
        </td>
        <td>
            <img src="output/1.7.3_test2image3.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 3</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_test2image5.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 5</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_test2image7.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 7</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_test2image10.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 10</figcaption>
          </td>
          <td>
            <img src="output/1.7.3_test2image20.png" align="middle" width="100px"/>
            <figcaption align="middle">i_start = 20</figcaption>
          </td>
      </tr>
      <br><br>
    </table>
  </div>


  <h2 align="middle">Part A - Section 1.8: Visual Anagrams</h2>
  <p>
    We can create optical illusions with diffusion models, where the image looks like one image right side up, but a different image upside down.
    We will denoise an image at step <b>t</b> to get a noise estimate. At the same time we will flip the image upside down and get another noise estimate.
    We flipped the second noise estimate to make it right side up and then average the two estimates. We then do a reverse diffusion step with the new
    averaged noise estimate:
    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <msub>
          <mi>&#x3F5;</mi>
          <mn>1</mn>
        </msub>
        <mo>=</mo>
        <mtext>UNet</mtext>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>x</mi>
          <mi>t</mi>
        </msub>
        <mo>,</mo>
        <mi>t</mi>
        <mo>,</mo>
        <msub>
          <mi>p</mi>
          <mn>1</mn>
        </msub>
        <mo stretchy="false">)</mo>
      </math>
      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <msub>
          <mi>&#x3F5;</mi>
          <mn>2</mn>
        </msub>
        <mo>=</mo>
        <mtext>flip</mtext>
        <mo stretchy="false">(</mo>
        <mtext>UNet</mtext>
        <mo stretchy="false">(</mo>
        <mtext>flip</mtext>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>x</mi>
          <mi>t</mi>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>,</mo>
        <mi>t</mi>
        <mo>,</mo>
        <msub>
          <mi>p</mi>
          <mn>2</mn>
        </msub>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
      </math>
      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <mi>&#x3F5;</mi>
        <mo>=</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>&#x3F5;</mi>
          <mn>1</mn>
        </msub>
        <mo>+</mo>
        <msub>
          <mi>&#x3F5;</mi>
          <mn>2</mn>
        </msub>
        <mo stretchy="false">)</mo>
        <mrow data-mjx-texclass="ORD">
          <mo>/</mo>
        </mrow>
        <mn>2</mn>
      </math>
  </p>

  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/anagram1.png" align="middle" width="100px"/>
            <figcaption align="right">(old man + people around campfire) anagram</figcaption>
          </td>
      <br><br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>
          <img src="output/anagram1f.png" align="middle" width="100px"/>
          <figcaption align="middle">anagram flipped</figcaption>
        </td>
      <br><br>
    </table>
  </div>

  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/anagram2.png" align="middle" width="100px"/>
            <figcaption align="middle">(mean wearing hat + snowy mountain village) anagram</figcaption>
          </td>

      <br><br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>

          <img src="output/anagram2f.png" align="middle" width="100px"/>
          <figcaption align="middle">anagram flipped</figcaption>
        </td>
      <br><br>
    </table>
  </div>

  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/anagram3.png" align="middle" width="100px"/>
            <figcaption align="middle">(skull + dog) anagram</figcaption>
          </td>

      <br><br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>

        <td>
          <img src="output/anagram3f.png" align="middle" width="100px"/>
          <figcaption align="middle">anagram flipped</figcaption>
        </td>
      <br><br>
    </table>
  </div>

  <h2 align="middle">Part A - Section 1.9: Hybrid Images</h2>
  <p>
    In order to create hybrid images with a diffusion model we can use a similar technique as in Section 1.8. We will create a composite noise estimate , by estimating the noise with two different text prompts, and then combining low frequencies from one noise estimate with high frequencies of the other. The algorithm is:
    <math xmlns="http://www.w3.org/1998/Math/MathML"display="block">
        <msub>
          <mi>&#x3F5;</mi>
          <mn>1</mn>
        </msub>
        <mo>=</mo>
        <mtext>UNet</mtext>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>x</mi>
          <mi>t</mi>
        </msub>
        <mo>,</mo>
        <mi>t</mi>
        <mo>,</mo>
        <msub>
          <mi>p</mi>
          <mn>1</mn>
        </msub>
        <mo stretchy="false">)</mo>
      </math>
      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <msub>
          <mi>&#x3F5;</mi>
          <mn>2</mn>
        </msub>
        <mo>=</mo>
        <mtext>UNet</mtext>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>x</mi>
          <mi>t</mi>
        </msub>
        <mo>,</mo>
        <mi>t</mi>
        <mo>,</mo>
        <msub>
          <mi>p</mi>
          <mn>2</mn>
        </msub>
        <mo stretchy="false">)</mo>
      </math>
      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <mi>&#x3F5;</mi>
        <mo>=</mo>
        <msub>
          <mi>f</mi>
          <mtext>lowpass</mtext>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>&#x3F5;</mi>
          <mn>1</mn>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msub>
          <mi>f</mi>
          <mtext>highpass</mtext>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>&#x3F5;</mi>
          <mn>2</mn>
        </msub>
        <mo stretchy="false">)</mo>
      </math>
</p>
<div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/hybrid1.png" align="middle" width="200px"/>
            <figcaption align="middle">skull + waterfall</figcaption>
          </td>
        <td>
          <img src="output/hybrid2.png" align="middle" width="200px"/>
          <figcaption align="middle">dog + almafi cost</figcaption>
        </td>
        <td>
            <img src="output/hybrid3.png" align="middle" width="200px"/>
            <figcaption align="middle">rocket ship + pencil</figcaption>
          </td>
      <br><br>
    </table>
  </div>
<br></br>
<br></br>
  <h1 align="middle">Part B: Diffusion Models from Scratch!</h1>

  <h2 align="middle">Part B - Section 1: Training a Single-Step Denoising UNet</h2>

<p>
    Given a noisy image <b>z</b>, we aim to train a denoiser <b>D<sub>&Theta;</sub></b> such that it maps <b>z</b> to a clean image <b>x</b>. 
    To do so, we can optimize over an L2 loss:
    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <mtable displaystyle="true">
          <mlabeledtr>
            <mtd id="mjx-eqn:B.1">
            </mtd>
            <mtd>
              <mi>L</mi>
              <mo>=</mo>
              <msub>
                <mrow data-mjx-texclass="ORD">
                  <mi mathvariant="double-struck">E</mi>
                </mrow>
                <mrow data-mjx-texclass="ORD">
                  <mi>z</mi>
                  <mo>,</mo>
                  <mi>x</mi>
                </mrow>
              </msub>
              <mo data-mjx-texclass="ORD" fence="false" stretchy="false">&#x2016;</mo>
              <msub>
                <mi>D</mi>
                <mrow data-mjx-texclass="ORD">
                  <mi>&#x3B8;</mi>
                </mrow>
              </msub>
              <mo stretchy="false">(</mo>
              <mi>z</mi>
              <mo stretchy="false">)</mo>
              <mo>&#x2212;</mo>
              <mi>x</mi>
              <msup>
                <mo data-mjx-texclass="ORD" fence="false" stretchy="false">&#x2016;</mo>
                <mn>2</mn>
              </msup>
            </mtd>
          </mlabeledtr>
        </mtable>
      </math>
</p>
  
<h3 align="middle">Part B - Section 1.1: Implementing the UNet</h3>
<div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/atomic_ops_new.png" align="middle" width="1000px"/>
            <figcaption align="middle">UNet Operations</figcaption>
          </td>
      <br><br>
    </table>
  </div>
  <p>
    Our UNet will comprised of various simple and composed operations. We can implement these operations' forward passes as building blocks for our net.
    <li><b>Conv</b> - Run a 2D batch normalization on a 2D convolution with stride length 1, then run a GELU function on that batch</li>
    <li><b>DownConv</b> - Run a 2D batch normalization on a 2D convolution with stride length 2, then run a GELU function on that batch</li>
    <li><b>UpConv</b> - Run a 2D batch normalization on a 2D convolution with stride length 2 and input padding, then run a GELU function on that batch</li>
    <li><b>Flatten</b> - Run 2D average pooling on tensor with kernel size 7</li>
    <li><b>Unflatten</b> - Run a 2D transposed convolution with kernel size 7 and stride length 1</li>
    <li><b>ConvBlock</b> - Call our previous 'Conv' operation on the tensor twice</li>
    <li><b>DownBlock</b> - Run the 'ConvBlock' operation on the 'DownConv' operation</li>
    <li><b>UpBlock</b> - Run the 'ConvBlock' operation on the 'UpConv' operation</li>
</p>
<div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/unconditional_arch.png" align="middle" width="1000px"/>
            <figcaption align="middle">Unconditional</figcaption>
          </td>
      <br><br>
    </table>
  </div>
  <p>
    For the unconditional UNet, the order of operations will be \[DownBlock \rightarrow DownBlock \rightarrow Flatten \rightarrow Unflatten \rightarrow
    UpBlock \rightarrow UpBlock \rightarrow Conv, \]
    where we have <b>ConvBlock</b> in <b>DownBlock</b> and <b>UpBlock</b>.
</p>
<h3 align="middle">Part B - Section 1.2: Using the UNet to Train a Denoiser</h3>
<p>
    To train our denoiser, we need to generate training data pairs of <b>(z,x)</b>, where each  is a clean MNIST digit. For each training batch,
     we can generate <b>z</b> from <b>x</b> using the the following noising process:
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <mtable displaystyle="true">
          <mlabeledtr>
            <mtd id="mjx-eqn:B.2">
            </mtd>
            <mtd>
              <mi>z</mi>
              <mo>=</mo>
              <mi>x</mi>
              <mo>+</mo>
              <mi>&#x3C3;</mi>
              <mi>&#x3F5;</mi>
              <mo>,</mo>
              <mstyle scriptlevel="0">
                <mspace width="1em"></mspace>
              </mstyle>
              <mtext>where&#xA0;</mtext>
              <mi>&#x3F5;</mi>
              <mo>&#x223C;</mo>
              <mi>N</mi>
              <mo stretchy="false">(</mo>
              <mn>0</mn>
              <mo>,</mo>
              <mi>I</mi>
              <mo stretchy="false">)</mo>
              <mo>.</mo>
            </mtd>
          </mlabeledtr>
        </mtable>
      </math>
</p>
<div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5bnoising.png" align="middle" width="800px"/>
            <figcaption align="middle">Noising Process</figcaption>
          </td>
      <br><br>
    </table>
  </div>
  <h3 align="middle">Part B - Section 1.2.1: Training</h3>
<p>
    Lets load our MNIST dataset and initialize our model, optimizer, loss function, and hyperparameters:
    <li>Batch Size is <b>256</b></li>
    <li><b>5</b> Epochs</li>
    <li>Learning Rate is <b>1e-4</b></li>
    <li>Sigma is <b>0.5</b></li>
    <li><b>128</b> Hidden Dimensions</li>
    <br>
    For each epoch, we will go through the training dataset, add noise to our clean digit, predict the denoised output using the model, then run the 
    loss function on the prediction and label.
</p>
<div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5bepoch1.png" align="middle" width="800px"/>
            <figcaption align="middle">After 1 Epoch</figcaption>
          </td>
      <br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5bepoch5.png" align="middle" width="800px"/>
            <figcaption align="middle">After 5 Epochs</figcaption>
          </td>
      <br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5buncondgraph.png" align="middle" width="500px"/>
            <figcaption align="middle">Training Loss Over Training Steps</figcaption>
          </td>
      <br>
    </table>
  </div>
  <h3 align="middle">Part B - Section 1.2.2: Out-of-Distribution Testing</h3>
  <p>The model was trained with sigma value 0.5. Lets see the results with varying sigma values.</p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5bood.png" align="middle" width="800px"/>
            <figcaption align="middle">Out-of-Distribution Sigma Values</figcaption>
          </td>
      <br>
    </table>
  </div>
  <h2 align="middle">Part B - Section 2: Training a Diffusion Model</h2>
  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
    <mtable displaystyle="true">
      <mlabeledtr>
        <mtd id="mjx-eqn:B.4">
        </mtd>
        <mtd>
          <mi>L</mi>
          <mo>=</mo>
          <msub>
            <mrow data-mjx-texclass="ORD">
              <mi mathvariant="double-struck">E</mi>
            </mrow>
            <mrow data-mjx-texclass="ORD">
              <mi>&#x3F5;</mi>
              <mo>,</mo>
              <msub>
                <mi>x</mi>
                <mn>0</mn>
              </msub>
              <mo>,</mo>
              <mi>t</mi>
            </mrow>
          </msub>
          <mo data-mjx-texclass="ORD" fence="false" stretchy="false">&#x2016;</mo>
          <msub>
            <mi>&#x3F5;</mi>
            <mrow data-mjx-texclass="ORD">
              <mi>&#x3B8;</mi>
            </mrow>
          </msub>
          <mo stretchy="false">(</mo>
          <msub>
            <mi>x</mi>
            <mi>t</mi>
          </msub>
          <mo>,</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
          <mo>&#x2212;</mo>
          <mi>&#x3F5;</mi>
          <msup>
            <mo data-mjx-texclass="ORD" fence="false" stretchy="false">&#x2016;</mo>
            <mn>2</mn>
          </msup>
          <mo>.</mo>
        </mtd>
      </mlabeledtr>
    </mtable>
  </math>
  <p>
    We have a new loss function, but we have a new variable timestep <b>t</b>. This means we need to inject this value into our UNet. 
  </p>
  <h3 align="middle">Part B - Section 2.1: Adding Time Conditioning to UNet</h3>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/conditional_arch.png" align="middle" width="800px"/>
            <figcaption align="middle">Time Conditioning</figcaption>
          </td>
      <br>
    </table>
  </div>
  <p>We need to add <b>FCBlock</b> to the Unflatten and UpBlock where the <b>FCBlock</b> is defined as:
\[Linear(GELU(Linear(tensor)))\]</p>
<h3 align="middle">Part B - Section 2.2: Training the UNet</h3>
<p>
    To train the model, we can load our optimizer, scheduler, and model again. We will use an Adam optimizer and an
    exponential learning rate decay scheduler. 

    In the forward process, we randomly sample <b>t</b> and add noise to input image/tensor. We can sample the alpha bar value 
    from the scheduler. Then to get <b>x<sub>t</sub></b>, we can calculate it with:
    \[
    x_t = \sqrt{\bar{\alpha}}x_0 + \sqrt{1 - \bar{\alpha}} * noise.
    \]
    Then we can get the predicted noise from the UNet using <b>x<sub>t</sub></b> and run MSE Loss on the 
    predicted noise and the noised image/tensor we got earlier.
</p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5b2.2-graph.png" align="middle" width="600px"/>
            <figcaption align="middle">Training Losses</figcaption>
          </td>
      <br>
    </table>
  </div>

  <h3 align="middle">Part B - Section 2.3: Sampling from the UNet</h3>
  <p>
    To sample from our model, we first randomly sample a noised image. Then we iterate timesteps <b>t</b> through <b>T = 300</b> steps, where at each step, we sample our
    alpha values given <b>t</b> and then get a tensor <b>z</b> based on <b>x<sub>t</sub></b> where if the timestep <b>t</b> is less than 1, the value is zero. We then get the 
    predicted noise from the UNet using <b>x<sub>t</sub></b> and <b>t</b>. Each step, we find:
    \[
    (1 / \sqrt{{\alpha_t}}) * (x_t - (1 - \alpha_t) / \sqrt{1 - \bar\alpha_t} * noise) + \sqrt{1 - \alpha_t} * z
    \]
  </p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5b2.2-5.png" align="middle" width="600px"/>
            <figcaption align="middle">5 Epochs</figcaption>
          </td>
      <br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5b2.2-20.png" align="middle" width="600px"/>
            <figcaption align="middle">20 Epochs</figcaption>
          </td>
      <br>
    </table>
  </div>
  <h3 align="middle">Part B - Section 2.4: Adding Class-Conditioning to UNet</h3>
  <p>
    Here, we will adding two more <b>FCBlocks</b> to our UNet. We have a class-conditioning vector <b>c</b> but we will make it a one-hot vector when 
    passing it into the <b>FCBlock</b>. We will add the new <b>FCBlocks</b> to the Unflatten and UpBlock.
  </p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5b2.4graph.png" align="middle" width="600px"/>
            <figcaption align="middle">Training Losses</figcaption>
          </td>
      <br>
    </table>
  </div>
  <h3 align="middle">Part B - Section 2.5: Sampling from the Class-Conditioned UNet</h3>
  <p>
    For sampling, we will include classifer-free guidance, using a gamma value of 5.0.
    \[
    \epsilon = \epsilon_u + \gamma(\epsilon_c - \epsilon_u)
    \]
    where <b>&epsilon;<sub>u</sub></b> is the unconditioned predicted noise and <b>&epsilon;<sub>c</sub></b> is the conditioned predicted noise. Then each 
    step, we find like before:
    \[
    (1 / \sqrt{{\alpha_t}}) * (x_t - (1 - \alpha_t) / \sqrt{1 - \bar\alpha_t} * noise) + \sqrt{1 - \alpha_t} * z
    \]
  </p>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5b2.5-5.png" align="middle" width="600px"/>
            <figcaption align="middle">5 Epochs</figcaption>
          </td>
      <br>
    </table>
  </div>
  <div align="middle">
    <table style="width=100%">
      <tr>
        <td>
            <img src="output/5b2.5-20.png" align="middle" width="600px"/>
            <figcaption align="middle">20 Epochs</figcaption>
          </td>
      <br>
    </table>
  </div>
</body>
</html>
